<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Global HD</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary: #3b82f6;
  --hover: #2563eb;
  --danger: #ef4444;
  --text: #f8fafc;
  --input: rgba(55,65,81,0.8);
  --scrollbar: #2563eb;
}

*{box-sizing:border-box;}
body{
  margin:0;
  font-family:'Segoe UI',Arial,sans-serif;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  /* imagem de fundo direta */
  background: url('https://i.im.ge/2026/01/29/eM6NzL.images.jpeg') no-repeat center center fixed;
  background-size: cover;
}

/* Painel */
.box{
  background: rgba(31,41,55,0.85); /* leve transpar√™ncia para ver fundo */
  width:100%;
  max-width:700px;
  padding:40px;
  border-radius:20px;
  box-shadow:0 25px 50px rgba(0,0,0,0.5);
  display:flex;
  flex-direction:column;
  gap:24px;
  color:var(--text);
  transition: all 0.3s;
}

/* T√≠tulos */
h2,h3{
  text-align:center;
  margin:0;
}

/* Inputs */
input{
  width:100%;
  padding:18px;
  border-radius:12px;
  border:1px solid rgba(71,85,105,0.8);
  background: var(--input);
  color:#f8fafc;
  font-size:18px;
  outline:none;
  transition: border 0.3s, box-shadow 0.3s;
}
input:focus{
  border:2px solid var(--primary);
  box-shadow:0 0 10px rgba(59,130,246,0.5);
}

/* Bot√µes */
button{
  width:100%;
  padding:18px;
  border:none;
  border-radius:14px;
  font-size:18px;
  font-weight:600;
  cursor:pointer;
  transition: all 0.3s;
  color:#fff;
  background:var(--primary);
}
button:hover{
  background:var(--hover);
  transform:translateY(-2px);
}

/* Esconder/Mostrar */
.hidden{display:none;}

/* ADMIN LISTA */
ul{
  padding:0;
  max-height:350px;
  overflow-y:auto;
  border-radius:12px;
  scrollbar-width:thin;
  scrollbar-color:var(--scrollbar) transparent;
}
ul::-webkit-scrollbar{
  width:8px;
}
ul::-webkit-scrollbar-thumb{
  background:var(--scrollbar);
  border-radius:10px;
}
li{
  list-style:none;
  background: rgba(44,62,80,0.85);
  padding:12px 16px;
  border-radius:12px;
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:17px;
  transition: background 0.2s;
}
li:hover{
  background: rgba(59,74,99,0.85);
}

/* Bot√£o remover bem pequeno */
.remove{
  background:var(--danger);
  padding:1px 4px;      /* bot√£o min√∫sculo */
  border-radius:4px;     /* discreto */
  font-size:10px;        /* pequeno */
  cursor:pointer;
  font-weight:700;
  color:#fff;
  transition: background 0.3s, transform 0.2s;
}
.remove:hover{
  background:#dc2626;
  transform:translateY(-1px);
}

/* Admin criar input/button juntos */
.create-container{
  display:flex;
  gap:12px;
}
.create-container input{flex:1;}
.create-container button{flex:0 0 150px;}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="box" id="loginBox">
  <h2>üîêKEY PREMIUM EGITAO</h2>
  <input id="loginUser" placeholder="üîëkey">
  <button onclick="login()">Entrar</button>
</div>

<!-- USU√ÅRIO NORMAL -->
<div class="box hidden" id="userBox">
  <h2>üë§ Bem-vindo</h2>
  <p style="text-align:center;font-size:18px;">Voc√™ ser√° redirecionado em breve...</p>
  <button onclick="logout()">Sair</button>
</div>

<!-- ADMIN PANEL -->
<div class="box hidden" id="adminBox">
  <h2>‚öô Painel Admin</h2>

  <div class="create-container">
    <input id="newUser" placeholder="Novo usu√°rio">
    <input id="diasUser" type="number" placeholder="Dias de validade">
    <button onclick="criarUsuario()">Criar</button>
  </div>

  <ul id="listaUsuarios"></ul>
  <button onclick="logoutAdmin()">Sair</button>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getFirestore, collection, addDoc, query, where, getDocs, onSnapshot, deleteDoc, doc, Timestamp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBRU1COppsLe_QJmmRmFRASW-w_5pdUMSw",
  authDomain: "teste-f56fb.firebaseapp.com",
  projectId: "teste-f56fb"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const usersRef = collection(db,"usuarios");

const ADMIN_USER="admin15996529204sas";
const LINK="https://keycrusher.xyz/";

let nomeAtual="", isAdmin=false;

// LOGIN
window.login=async()=>{
  const u = loginUser.value.trim();
  if(!u) return alert("Digite seu usu√°rio");

  // Admin
  if(u.toLowerCase() === ADMIN_USER){
    nomeAtual="ADMIN"; isAdmin=true;
    loginBox.classList.add("hidden");
    adminBox.classList.remove("hidden");
    ouvirUsuarios();
    return;
  }

  // Usu√°rio normal
  const q=query(usersRef,where("user","==",u));
  const snap=await getDocs(q);
  if(snap.empty) return alert("Usu√°rio n√£o encontrado");

  const userData = snap.docs[0].data();
  const userId = snap.docs[0].id;

  // Verifica expira√ß√£o
  if(userData.expira && userData.expira.toDate() < new Date()){
    return alert("Conta expirada");
  }

  nomeAtual=userData.user;

  // Redireciona para o link
  loginBox.classList.add("hidden");
  userBox.classList.remove("hidden");
  setTimeout(()=>{ window.location.href = LINK; }, 1000);
}

// CRIAR USU√ÅRIO
window.criarUsuario=async()=>{
  const novo = newUser.value.trim();
  const dias = parseInt(diasUser.value);
  if(!novo) return alert("Digite um nome de usu√°rio");
  if(!dias || dias < 1) return alert("Digite os dias de validade");

  const q = query(usersRef, where("user", "==", novo));
  const snap = await getDocs(q);
  if(!snap.empty) return alert("Usu√°rio j√° existe");

  const dataExpira = Timestamp.fromDate(new Date(Date.now() + dias*24*60*60*1000));

  await addDoc(usersRef, {user: novo, expira: dataExpira});
  newUser.value="";
  diasUser.value="";
  alert("Usu√°rio criado com validade de " + dias + " dias!");
}

// OUVE USU√ÅRIOS
function ouvirUsuarios(){
  onSnapshot(usersRef,snap=>{
    listaUsuarios.innerHTML="";
    snap.forEach(docSnap=>{
      const u = docSnap.data();
      const li = document.createElement("li");
      li.textContent = u.user + (u.expira ? " (Expira: "+u.expira.toDate().toLocaleDateString()+")" : "");

      const r = document.createElement("button");
      r.textContent="X";
      r.className="remove";
      r.onclick = async () => { await deleteDoc(doc(db,"usuarios",docSnap.id)); };

      li.appendChild(r);
      listaUsuarios.appendChild(li);
    });
  });
}

// LOGOUT USU√ÅRIO NORMAL
window.logout=()=> {
  userBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
  loginUser.value = "";
}

// LOGOUT ADMIN
window.logoutAdmin=()=> {
  adminBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
  loginUser.value = "";
}
</script>

</body>
</html>